!function(){var e={inArray:function(e,n){var o;for(o=0;o<n.length;o++)if(n[o]==e)return!0;return!1},imgPing:function(e){var n=new Image,o="_img_"+Math.random();window[o]=n,n.onload=n.onerror=function(){window[o]=null},n.src=e},setCookie:function(e,n,o){if("number"==typeof o.expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*o.expires),o.expires=i}return n=encodeURIComponent(String(n)),n=n.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",n,o.expires&&"; expires="+o.expires.toUTCString(),o.path&&"; path="+o.path,o.domain&&"; domain="+o.domain,o.secure?"; secure":""].join("")},getCookie:function(e){for(var n,o=document.cookie?document.cookie.split("; "):[],i=/(%[0-9A-Z]{2})+/g,t=0;t<o.length;t++){var a=o[t].split("="),r=a[0].replace(i,decodeURIComponent),c=a.slice(1).join("=");if('"'===c.charAt(0)&&(c=c.slice(1,-1)),c=c.replace(i,decodeURIComponent),e===r){n=c;break}e||(n[r]=c)}return n},objToQuery:function(e){if("object"==typeof e){var n,o="";for(n in e)o+=""===o?n+"="+window.encodeURIComponent(e[n]):"&"+n+"="+window.encodeURIComponent(e[n]);return o}}},n={advertLoad:[]},o=function(o,i,t,a,r,c){if(!(window.location.protocol&&window.location.protocol.indexOf("file:")>=0)){var d=function(e){var n={client_id:t};o.ajax({url:"http://changyan.sohu.com/api/2/user/info",cache:!1,dataType:"jsonp",data:n,success:function(n){e(n)},error:function(){e()}})},p=function(i,d){var p="",d=d||0;window.changyan&&window.changyan.api&&"function"==typeof window.changyan.api.ready?window.changyan.api.ready(function(e){var n=e.getUUID();"string"==typeof n&&32===n.length&&(p=n)}):window.cyan&&window.cyan.api&&"function"==typeof window.cyan.api.ready&&window.cyan.api.ready(function(e){var n=e.getUUID();"string"==typeof n&&32===n.length&&(p=n)});var s=function(n,o,i,a,r,c,s,l,u,g,f){var y={appId:t,advertId:n,agencyType:o,pce:i,tag:a,ref:r,uuid:p,uid:d};void 0!==c&&(y.rtbAdId=c),void 0!==s&&(y.winNoticeUrl=s),void 0!==l&&(y.dspId=l),void 0!==u&&(y.type=u),void 0!==g&&(y.category=g),void 0!==f&&(y.isCookieMapping=f),e.imgPing("http://e.changyan.sohu.com/dataService/v2/pv?"+e.objToQuery(y))},l=function(e,n,o,i,a,r,c,s,l,u,g){var f={appId:t,advertId:e,agencyType:n,pce:o,tag:i,ref:a,category:u,uuid:p,uid:d};void 0!==r&&(f.rtbAdId=r),void 0!==c&&(f.dspId=c),void 0!==s&&(f.isCookieMapping=s),void 0!==l&&(f.type=l),void 0!==g&&(f.landingUrl=g);var y,h="http://e.changyan.sohu.com/dataService/v2/click?";for(y in f)h+=y+"="+window.encodeURIComponent(f[y])+"&";h.substring(0,h.length-1),f.landingUrl&&window.open(h)},u={appId:t,category:a,title:r,url:c,position:i,uuid:p,uid:d};1607===u.position&&(u.isLeft=!0),1608===u.position&&(u.isLeft=!1,u.position=1607),o.ajax({url:"http://e.changyan.sohu.com/dataService/v2/getData",data:u,dataType:"jsonp",success:function(i){if(0===i.code){var a={};("RTB"===i.agencyType||"AGENCY"===i.agencyType)&&(a=o.parseJSON(i.advertContent),function(){a.exposure_urls instanceof window.Array&&o.each(a.exposure_urls,function(n,i){i.exposureUrl instanceof window.Array&&"number"==typeof i.timeMillis&&o.each(i.exposureUrl,function(n,o){e.imgPing(o)})})}()),i.cookieMappingList&&i.cookieMappingList.length&&o.each(i.cookieMappingList,function(n,o){e.imgPing(o)}),s(i.advertId,i.agencyType,i.pce,i.tag,i.ref,a.rtbAdId,a.winNoticeUrl,a.dspId,a.type,a.category,a.isCookieMapping),i.params=u,i.sendClickLog=function(){"RTB"===i.agencyType&&a.clickUrls&&a.clickUrls.length&&o.each(a.clickUrls,function(n,o){e.imgPing(o)}),l(i.advertId,i.agencyType,i.pce,i.tag,i.ref,a.rtbAdId,a.dspId,a.cookieMapping,a.type,a.category,a.landingUrl)},i.statVisibility=function(n){var r={IMAGE:"0",FLASH:"1",JS:"3",IFRAME:"5"},c={appId:t,advertId:i.advertId,agencyType:i.agencyType,showType:r[i.advertType],uuid:p,uid:d};"RTB"===i.agencyType&&(c=o.extend(c,{rtbAdId:a.rtbAdId,dspId:a.dspId}));var s="http://e.changyan.sohu.com/dataService/v2/visibility?",l=!1,u=o(window);u.on("scroll.ad"+i.params.position,function(){var i=n.offset().top-u.height()+n.height()/2;u.scrollTop()>=i&&u.scrollTop()<=i+u.height()&&(l||(window.setTimeout(function(){if(u.scrollTop()>=i&&u.scrollTop()<=i+u.height()){c=o.extend(c,{screenWidth:u.width(),screenHeight:u.height(),Xcoordinate:n.offset().left,Ycoordinate:n.offset().top});var t;for(t in c)s+=t+"="+decodeURIComponent(c[t])+"&";e.imgPing(s.substring(0,s.length-1))}else l=!1},1e3),l=!0))}),u.trigger("scroll")};var r,c=n.advertLoad;for(r=0;r<c.length;r++)c[r](i)}}})},s=function(e){o.ajax({url:"http://e.changyan.sohu.com/dataService/getConfig",data:{appId:t},dataType:"jsonp",success:function(n){0===n.code&&"function"==typeof e&&e(n)}})};s(function(n){if(n){var t=["1103","1105","6103"];if(0===n.status){var r,c=[];for(r=0;r<n.positions.length;r++)e.inArray(n.positions[r],t)&&c.push(n.positions[r]);n.status=1,n.positions=c}if(1===n.status){var s=!1;if(n.disabledChannels&&n.disabledChannels.length&&!function(){var e;for(e=0;e<n.disabledChannels.length;e++)n.disabledChannels[e]===a&&(s=!0)}(),n.positions&&n.positions.length){var l=function(a){var r,c,d=function(){o(".post-default-w").one("click",function(){p(1105,a)})};for(r=0;r<n.positions.length;r++)c=parseInt(n.positions[r],10),"wap"===i&&5e3>c||"pc"===i&&c>5e3||(e.inArray(n.positions[r],t)||!s)&&!("pc"===i&&1530===c&&!document.getElementById("SOHUCS")&&s||"pc"===i&&1103===c&&(!o("#SOHUCS #SOHU_MAIN .list-newest-w .block-cont-gw").length||o("#SOHUCS #SOHU_MAIN .list-newest-w .block-cont-gw").length<5)||"wap"===i&&6103===c&&(!o("#SOHUCS #cy-latest-list-wrapper article").length||o("#SOHUCS #cy-latest-list-wrapper article").length<5)||!("pc"===i&&1105===c&&(!o("#SOHUCS").length||o("#SOHUCS").width()<570||o("#SOHUCS").width()>800||o(".post-default-w").length)?o(".post-default-w").length&&d():p(c,a)))};"mark"===e.getCookie("cy-mark")?d(function(n){var o;n&&n.user_id?o=n.user_id:e.setCookie("cy-mark",null,{expires:-1,path:"/"}),l(o)}):(l(),window.setTimeout(function(){d(function(n){n&&n.user_id&&e.setCookie("cy-mark","mark",{expires:30,path:"/"})})},5e3))}}}})}},i=function(e){if(window.XMLHttpRequest){var n=e.type,i=e.appId,t="null",a=window.document.title,r=window.location.href;"pc"!==n&&"wap"!==n&&(n="pc"),e.hasOwnProperty("categoryId")&&void 0!==e.categoryId&&(t=e.categoryId),e.hasOwnProperty("title")&&(a=e.title),e.hasOwnProperty("url")&&(r=e.url),o(window.changyanjQuery||window.cyanZepto||window.jQuery,n,i,t,a,r)}};i.on=function(e,o){n[e]&&"function"==typeof o&&n[e].push(o)},"function"!=typeof window.changyanDSP&&(window.changyanDSP=i)}();